const { MongoClient } = require('mongodb')
const { scrapeFriendsGuildParkEvents } = require('./scrape-friends-guild-park')
const { scrapeROMEvents } = require('./scrape-rom')
const { scrapeHorseshoeTavernEvents } = require('./scrape-horseshoe-tavern')
const { scrapeTBGEvents } = require('./scrape-toronto-botanical-garden')
const { scrapeMOCAEvents } = require('./scrape-moca')
const { scrapeGerrardIndiaBazaarEvents } = require('./scrape-gerrard-india-bazaar')
const { scrapeTorontoZooEvents } = require('./scrape-toronto-zoo')
const { scrapeRoncesvallesVillageEvents } = require('./scrape-roncesvalles-village')
const { scrapeNiagaraFallsEvents } = require('./scrape-niagara-falls')
const { scrapeMarkhamEvents } = require('./scrape-markham')
const { scrapeSquareOneEvents } = require('./scrape-square-one')
const { scrapeWetNWildEvents } = require('./scrape-wetnwild-toronto')

// Additional major Toronto venues
const { scrapeAGOEvents } = require('./scrape-ago-events')
const { scrapeHarbourfrontEvents } = require('./scrape-harbourfront-events')
const { scrapeCasaLomaEvents } = require('./scrape-casa-loma-events')
const { scrapeDistilleryDistrictEvents } = require('./scrape-distillery-district-events')
const { scrapeRBGEvents } = require('./scrape-rbg-events')
const { scrapeGardinerMuseumEvents } = require('./scrape-gardiner-museum-events')
const { scrapeRipleysAquariumEvents } = require('./scrape-ripleysaquarium-events')
const { scrapeHighParkEvents } = require('./scrape-highpark-events')
const { scrapeEvergreenBrickWorksEvents } = require('./scrape-evergreen-brick-works-events')
const { scrapeTorontoLibraryEvents } = require('./scrape-toronto-library-events')

// New scrapers
const scrapeRiverwoodConservancyEvents = require('./scrape-riverwood-conservancy')
const scrapeUnionvilleEvents = require('./scrape-unionville-events')

// Major Toronto Festival Scrapers
const { scrapeEvents: scrapeTIFFEvents } = require('./scrape-toronto-international-film-festival')
const { scrapeEvents: scrapeCaribanaEvents } = require('./scrape-caribana-festival')
const { scrapeEvents: scrapeTorontoPrideEvents } = require('./scrape-toronto-pride')

// Toronto Nightlife Venues
const { scrapeFutureNightlifeEvents } = require('./scrape-future-nightlife-events')
const { scrapeNestTorontoEvents } = require('./scrape-nest-toronto-events')
const { scrapeOasisAqualoungeEvents } = require('./scrape-oasis-aqualounge-events')
const { scrapeRebelNightclubEvents } = require('./scrape-rebel-nightclub-events')
const { scrapeToyboxTorontoEvents } = require('./scrape-toybox-toronto-events')
const { scrape44TorontoEvents } = require('./scrape-44toronto-events')
const { scrapeCenturyEvents } = require('./scrape-century-events')
const { scrapeDprtmntEvents } = require('./scrape-dprtmnt-events')
const { scrapeFictionClubEvents } = require('./scrape-fiction-club-events')
const { scrapeLost577Events } = require('./scrape-lost577-events')
const { scrapeMiaTorontoEvents } = require('./scrape-mia-toronto-events')
const { scrapeVelvetEvents } = require('./scrape-velvet-events')
const { scrapeVertigoEvents } = require('./scrape-vertigo-events')
const { scrapeRevivalEventVenueEvents } = require('./scrape-revival-event-venue-events')
const { scrapeLulaLoungeEvents } = require('./scrape-lula-lounge-events')
const { scrapeClub54Events } = require('./scrape-club54-events')
const { scrapeXClubEvents } = require('./scrape-xclub-events')
const { scrapeDirtyMartiniEvents } = require('./scrape-dirty-martini-events')
const { scrape6ixLoungeEvents } = require('./scrape-6ix-lounge-events')
const { scrapeSeventySevenEvents } = require('./scrape-seventy-seven-events')

// NEW GTA VENUE SCRAPERS - Major venues across the Greater Toronto Area
const DanforthMusicHallScraper = require('./scrape-danforth-music-hall')
const PhoenixConcertTheatreScraper = require('./scrape-phoenix-concert-theatre')
const OperaHouseScraper = require('./scrape-opera-house')
const LivingArtsCentreScraper = require('./scrape-living-arts-centre')
const RoseTheatreScraper = require('./scrape-rose-theatre')
const MarkhamTheatreScraper = require('./scrape-markham-theatre')
const BurlingtonPerformingArtsScraper = require('./scrape-burlington-performing-arts')
const OakvilleCentreScraper = require('./scrape-oakville-centre')
const RichmondHillCentreScraper = require('./scrape-richmond-hill-centre')
const VaughanMillsEventsScraper = require('./scrape-vaughan-mills-events')
const RegentTheatreOshawaScraper = require('./scrape-regent-theatre-oshawa')
const PickeringCasinoEventsScraper = require('./scrape-pickering-casino-events')
const UniversityOfTorontoEventsScraper = require('./scrape-university-of-toronto-events')
const YorkUniversityEventsScraper = require('./scrape-york-university-events')
const AjaxCommunityEventsScraper = require('./scrape-ajax-community-events')

/**
 * Run all Toronto event scrapers
 */
async function scrapeAllTorontoEvents(city = 'Toronto') {
  // Use passed city parameter or default to Toronto for folder-based authority
  const targetCity = city || 'Toronto';
  if (!targetCity) {
    console.error('âŒ City argument is required. e.g. node scrape-all-toronto.js Toronto')
    process.exit(1);
  }
  const mongoUri = process.env.MONGODB_URI || 'mongodb://localhost:27017/discovr';
  const client = new MongoClient(mongoUri);

  try {
    console.log('ğŸ”— Connecting to MongoDB...')
    await client.connect();

    const db = client.db('discovr')
    const eventsCollection = client.db('events').collection('events')

    console.log('ğŸš€ Starting comprehensive Toronto event scraping...')
    console.log('=' .repeat(60));

    let totalAdded = 0;

    // 1. Gerrard India Bazaar
    console.log('\nğŸ“ 1. Scraping Gerrard India Bazaar...')
    try {
      const added1 = await scrapeGerrardIndiaBazaarEvents(eventsCollection);
      totalAdded += added1;
      console.log(`âœ… Gerrard India Bazaar: ${added1} events`);
    } catch (error) {
      console.error(`âŒ Gerrard India Bazaar failed: ${error.message}`);
    }

    // 2. Friends of Guild Park
    console.log('\nğŸ“ 2. Scraping Friends of Guild Park...')
    try {
      const added2 = await scrapeFriendsGuildParkEvents(eventsCollection);
      totalAdded += added2;
      console.log(`âœ… Friends of Guild Park: ${added2} events`);
    } catch (error) {
      console.error(`âŒ Friends of Guild Park failed: ${error.message}`);
    }

    // 3. Royal Ontario Museum
    console.log('\nğŸ“ 3. Scraping Royal Ontario Museum...')
    try {
      const added3 = await scrapeROMEvents(eventsCollection);
      totalAdded += added3;
      console.log(`âœ… Royal Ontario Museum: ${added3} events`);
    } catch (error) {
      console.error(`âŒ Royal Ontario Museum failed: ${error.message}`);
    }

    // 4. Horseshoe Tavern
    console.log('\nğŸ“ 4. Scraping Horseshoe Tavern...')
    try {
      const added4 = await scrapeHorseshoeTavernEvents(eventsCollection);
      totalAdded += added4;
      console.log(`âœ… Horseshoe Tavern: ${added4} events`);
    } catch (error) {
      console.error(`âŒ Horseshoe Tavern failed: ${error.message}`);
    }

    // 5. Toronto Botanical Garden
    console.log('\nğŸ“ 5. Scraping Toronto Botanical Garden...')
    try {
      const added5 = await scrapeTBGEvents(eventsCollection);
      totalAdded += added5;
      console.log(`âœ… Toronto Botanical Garden: ${added5} events`);
    } catch (error) {
      console.error(`âŒ Toronto Botanical Garden failed: ${error.message}`);
    }

    // 6. MOCA Toronto
    console.log('\nğŸ“ 6. Scraping MOCA Toronto...')
    try {
      const added6 = await scrapeMOCAEvents(eventsCollection);
      totalAdded += added6;
      console.log(`âœ… MOCA Toronto: ${added6} events`);
    } catch (error) {
      console.error(`âŒ MOCA Toronto failed: ${error.message}`);
    }

    // 7. Toronto Zoo
    console.log('\nğŸ“ 7. Scraping Toronto Zoo...')
    try {
      const added7 = await scrapeTorontoZooEvents(eventsCollection);
      totalAdded += added7;
      console.log(`âœ… Toronto Zoo: ${added7} events`);
    } catch (error) {
      console.error(`âŒ Toronto Zoo failed: ${error.message}`);
    }

    // 8. Roncesvalles Village
    console.log('\nğŸ“ 8. Scraping Roncesvalles Village...')
    try {
      const added8 = await scrapeRoncesvallesVillageEvents(eventsCollection);
      totalAdded += added8;
      console.log(`âœ… Roncesvalles Village: ${added8} events`);
    } catch (error) {
      console.error(`âŒ Roncesvalles Village failed: ${error.message}`);
    }

    // 9. Niagara Falls
    console.log('\nğŸ“ 9. Scraping Niagara Falls...')
    try {
      const added9 = await scrapeNiagaraFallsEvents(eventsCollection);
      totalAdded += added9;
      console.log(`âœ… Niagara Falls: ${added9} events`);
    } catch (error) {
      console.error(`âŒ Niagara Falls failed: ${error.message}`);
    }

    // 10. City of Markham
    console.log('\nğŸ“ 10. Scraping City of Markham...')
    try {
      const added10 = await scrapeMarkhamEvents(eventsCollection);
      totalAdded += added10;
      console.log(`âœ… City of Markham: ${added10} events`);
    } catch (error) {
      console.error(`âŒ City of Markham failed: ${error.message}`);
    }

    // 11. Square One Shopping Centre
    console.log('\nğŸ“ 11. Scraping Square One Shopping Centre...')
    try {
      const added11 = await scrapeSquareOneEvents(eventsCollection);
      totalAdded += added11;
      console.log(`âœ… Square One Shopping Centre: ${added11} events`);
    } catch (error) {
      console.error(`âŒ Square One Shopping Centre failed: ${error.message}`);
    }

    // 12. Wet'n'Wild Toronto
    console.log('\nğŸ“ 12. Scraping Wet\'n\'Wild Toronto...')
    try {
      const added12 = await scrapeWetNWildEvents(eventsCollection);
      totalAdded += added12;
      console.log(`âœ… Wet\'n\'Wild Toronto: ${added12} events`);
    } catch (error) {
      console.error(`âŒ Wet\'n\'Wild Toronto failed: ${error.message}`);
    }

    // 13. Art Gallery of Ontario (AGO)
    console.log('\nğŸ“ 13. Scraping Art Gallery of Ontario...')
    try {
      const added13 = await scrapeAGOEvents(eventsCollection);
      totalAdded += added13;
      console.log(`âœ… Art Gallery of Ontario: ${added13} events`);
    } catch (error) {
      console.error(`âŒ Art Gallery of Ontario failed: ${error.message}`);
    }

    // 14. Harbourfront Centre
    console.log('\nğŸ“ 14. Scraping Harbourfront Centre...')
    try {
      const added14 = await scrapeHarbourfrontEvents(eventsCollection);
      totalAdded += added14;
      console.log(`âœ… Harbourfront Centre: ${added14} events`);
    } catch (error) {
      console.error(`âŒ Harbourfront Centre failed: ${error.message}`);
    }

    // 15. Casa Loma
    console.log('\nğŸ“ 15. Scraping Casa Loma...')
    try {
      const added15 = await scrapeCasaLomaEvents(eventsCollection);
      totalAdded += added15;
      console.log(`âœ… Casa Loma: ${added15} events`);
    } catch (error) {
      console.error(`âŒ Casa Loma failed: ${error.message}`);
    }

    // 16. Distillery District
    console.log('\nğŸ“ 16. Scraping Distillery District...')
    try {
      const added16 = await scrapeDistilleryDistrictEvents(eventsCollection);
      totalAdded += added16;
      console.log(`âœ… Distillery District: ${added16} events`);
    } catch (error) {
      console.error(`âŒ Distillery District failed: ${error.message}`);
    }

    // 17. Royal Botanical Gardens
    console.log('\nğŸ“ 17. Scraping Royal Botanical Gardens...')
    try {
      const added17 = await scrapeRBGEvents(eventsCollection);
      totalAdded += added17;
      console.log(`âœ… Royal Botanical Gardens: ${added17} events`);
    } catch (error) {
      console.error(`âŒ Royal Botanical Gardens failed: ${error.message}`);
    }

    // 18. Gardiner Museum
    console.log('\nğŸ“ 18. Scraping Gardiner Museum...')
    try {
      const added18 = await scrapeGardinerMuseumEvents(eventsCollection);
      totalAdded += added18;
      console.log(`âœ… Gardiner Museum: ${added18} events`);
    } catch (error) {
      console.error(`âŒ Gardiner Museum failed: ${error.message}`);
    }

    // 19. Ripley's Aquarium
    console.log('\nğŸ“ 19. Scraping Ripley\'s Aquarium...')
    try {
      const added19 = await scrapeRipleysAquariumEvents(eventsCollection);
      totalAdded += added19;
      console.log(`âœ… Ripley\'s Aquarium: ${added19} events`);
    } catch (error) {
      console.error(`âŒ Ripley\'s Aquarium failed: ${error.message}`);
    }

    // 20. High Park
    console.log('\nğŸ“ 20. Scraping High Park...')
    try {
      const added20 = await scrapeHighParkEvents(eventsCollection);
      totalAdded += added20;
      console.log(`âœ… High Park: ${added20} events`);
    } catch (error) {
      console.error(`âŒ High Park failed: ${error.message}`);
    }

    // 21. Evergreen Brick Works
    console.log('\nğŸ“ 21. Scraping Evergreen Brick Works...')
    try {
      const added21 = await scrapeEvergreenBrickWorksEvents(eventsCollection);
      totalAdded += added21;
      console.log(`âœ… Evergreen Brick Works: ${added21} events`);
    } catch (error) {
      console.error(`âŒ Evergreen Brick Works failed: ${error.message}`);
    }

    // 22. Toronto Public Library
    console.log('\nğŸ“ 22. Scraping Toronto Public Library...')
    try {
      const added22 = await scrapeTorontoLibraryEvents(eventsCollection);
      totalAdded += added22;
      console.log(`âœ… Toronto Public Library: ${added22} events`);
    } catch (error) {
      console.error(`âŒ Toronto Public Library failed: ${error.message}`);
    }

    // 23. Riverwood Conservancy
    console.log('\nğŸ“ 23. Scraping Riverwood Conservancy...')
    try {
      const added23 = await scrapeRiverwoodConservancyEvents(eventsCollection);
      totalAdded += added23;
      console.log(`âœ… Riverwood Conservancy: ${added23} events`);
    } catch (error) {
      console.error(`âŒ Riverwood Conservancy failed: ${error.message}`);
    }

    // 24. Main Street Unionville
    console.log('\nğŸ“ 24. Scraping Main Street Unionville...')
    try {
      const added24 = await scrapeUnionvilleEvents(eventsCollection);
      totalAdded += added24;
      console.log(`âœ… Main Street Unionville: ${added24} events`);
    } catch (error) {
      console.error(`âŒ Main Street Unionville failed: ${error.message}`);
    }

    // 25. Future Nightlife
    console.log('\nğŸ“ 25. Scraping Future Nightlife...')
    try {
      const added25 = await scrapeFutureNightlifeEvents(eventsCollection);
      totalAdded += added25;
      console.log(`âœ… Future Nightlife: ${added25} events`);
    } catch (error) {
      console.error(`âŒ Future Nightlife failed: ${error.message}`);
    }

    // 26. Nest Toronto
    console.log('\nğŸ“ 26. Scraping Nest Toronto...')
    try {
      const added26 = await scrapeNestTorontoEvents(eventsCollection);
      totalAdded += added26;
      console.log(`âœ… Nest Toronto: ${added26} events`);
    } catch (error) {
      console.error(`âŒ Nest Toronto failed: ${error.message}`);
    }

    // 27. Oasis Aqualounge
    console.log('\nğŸ“ 27. Scraping Oasis Aqualounge...')
    try {
      const added27 = await scrapeOasisAqualoungeEvents(eventsCollection);
      totalAdded += added27;
      console.log(`âœ… Oasis Aqualounge: ${added27} events`);
    } catch (error) {
      console.error(`âŒ Oasis Aqualounge failed: ${error.message}`);
    }

    // 28. Rebel Nightclub
    console.log('\nğŸ“ 28. Scraping Rebel Nightclub...')
    try {
      const added28 = await scrapeRebelNightclubEvents(eventsCollection);
      totalAdded += added28;
      console.log(`âœ… Rebel Nightclub: ${added28} events`);
    } catch (error) {
      console.error(`âŒ Rebel Nightclub failed: ${error.message}`);
    }

    // 29. Toybox Toronto
    console.log('\nğŸ“ 29. Scraping Toybox Toronto...')
    try {
      const added29 = await scrapeToyboxTorontoEvents(eventsCollection);
      totalAdded += added29;
      console.log(`âœ… Toybox Toronto: ${added29} events`);
    } catch (error) {
      console.error(`âŒ Toybox Toronto failed: ${error.message}`);
    }

    // 30. 44 Toronto
    console.log('\nğŸ“ 30. Scraping 44 Toronto...')
    try {
      const added30 = await scrape44TorontoEvents(eventsCollection);
      totalAdded += added30;
      console.log(`âœ… 44 Toronto: ${added30} events`);
    } catch (error) {
      console.error(`âŒ 44 Toronto failed: ${error.message}`);
    }

    // 31. Century
    console.log('\nğŸ“ 31. Scraping Century...')
    try {
      const added31 = await scrapeCenturyEvents(eventsCollection);
      totalAdded += added31;
      console.log(`âœ… Century: ${added31} events`);
    } catch (error) {
      console.error(`âŒ Century failed: ${error.message}`);
    }

    // 32. DPRTMNT
    console.log('\nğŸ“ 32. Scraping DPRTMNT...')
    try {
      const added32 = await scrapeDprtmntEvents(eventsCollection);
      totalAdded += added32;
      console.log(`âœ… DPRTMNT: ${added32} events`);
    } catch (error) {
      console.error(`âŒ DPRTMNT failed: ${error.message}`);
    }

    // 33. Fiction Club
    console.log('\nğŸ“ 33. Scraping Fiction Club...')
    try {
      const added33 = await scrapeFictionClubEvents(eventsCollection);
      totalAdded += added33;
      console.log(`âœ… Fiction Club: ${added33} events`);
    } catch (error) {
      console.error(`âŒ Fiction Club failed: ${error.message}`);
    }

    // 34. Lost 577
    console.log('\nğŸ“ 34. Scraping Lost 577...')
    try {
      const added34 = await scrapeLost577Events(eventsCollection);
      totalAdded += added34;
      console.log(`âœ… Lost 577: ${added34} events`);
    } catch (error) {
      console.error(`âŒ Lost 577 failed: ${error.message}`);
    }

    // 35. MIA Toronto
    console.log('\nğŸ“ 35. Scraping MIA Toronto...')
    try {
      const added35 = await scrapeMiaTorontoEvents(eventsCollection);
      totalAdded += added35;
      console.log(`âœ… MIA Toronto: ${added35} events`);
    } catch (error) {
      console.error(`âŒ MIA Toronto failed: ${error.message}`);
    }

    // 36. The Velvet
    console.log('\nğŸ“ 36. Scraping The Velvet...')
    try {
      const added36 = await scrapeVelvetEvents(eventsCollection);
      totalAdded += added36;
      console.log(`âœ… The Velvet: ${added36} events`);
    } catch (error) {
      console.error(`âŒ The Velvet failed: ${error.message}`);
    }

    // 37. Vertigo
    console.log('\nğŸ“ 37. Scraping Vertigo...')
    try {
      const added37 = await scrapeVertigoEvents(eventsCollection);
      totalAdded += added37;
      console.log(`âœ… Vertigo: ${added37} events`);
    } catch (error) {
      console.error(`âŒ Vertigo failed: ${error.message}`);
    }

    // 38. Revival Event Venue
    console.log('\nğŸ“ 38. Scraping Revival Event Venue...')
    try {
      const added38 = await scrapeRevivalEventVenueEvents(eventsCollection);
      totalAdded += added38;
      console.log(`âœ… Revival Event Venue: ${added38} events`);
    } catch (error) {
      console.error(`âŒ Revival Event Venue failed: ${error.message}`);
    }

    // 39. Lula Lounge
    console.log('\nğŸ“ 39. Scraping Lula Lounge...')
    try {
      const added39 = await scrapeLulaLoungeEvents(eventsCollection);
      totalAdded += added39;
      console.log(`âœ… Lula Lounge: ${added39} events`);
    } catch (error) {
      console.error(`âŒ Lula Lounge failed: ${error.message}`);
    }

    // 40. Club 54
    console.log('\nğŸ“ 40. Scraping Club 54...')
    try {
      const added40 = await scrapeClub54Events(eventsCollection);
      totalAdded += added40;
      console.log(`âœ… Club 54: ${added40} events`);
    } catch (error) {
      console.error(`âŒ Club 54 failed: ${error.message}`);
    }

    // 41. The X Club
    console.log('\nğŸ“ 41. Scraping The X Club...')
    try {
      const added41 = await scrapeXClubEvents(eventsCollection);
      totalAdded += added41;
      console.log(`âœ… The X Club: ${added41} events`);
    } catch (error) {
      console.error(`âŒ The X Club failed: ${error.message}`);
    }

    // 42. Dirty Martini
    console.log('\nğŸ“ 42. Scraping Dirty Martini...')
    try {
      const added42 = await scrapeDirtyMartiniEvents(eventsCollection);
      totalAdded += added42;
      console.log(`âœ… Dirty Martini: ${added42} events`);
    } catch (error) {
      console.error(`âŒ Dirty Martini failed: ${error.message}`);
    }

    // 43. The 6ix Lounge
    console.log('\nğŸ“ 43. Scraping The 6ix Lounge...')
    try {
      const added43 = await scrape6ixLoungeEvents(eventsCollection);
      totalAdded += added43;
      console.log(`âœ… The 6ix Lounge: ${added43} events`);
    } catch (error) {
      console.error(`âŒ The 6ix Lounge failed: ${error.message}`);
    }

    // 44. Seventy Seven
    console.log('\nğŸ“ 44. Scraping Seventy Seven...')
    try {
      const added44 = await scrapeSeventySevenEvents(eventsCollection);
      totalAdded += added44;
      console.log(`âœ… Seventy Seven: ${added44} events`);
    } catch (error) {
      console.error(`âŒ Seventy Seven failed: ${error.message}`);
    }

    console.log('\nğŸ­ === MAJOR TORONTO FESTIVALS ===')

    // 45. Toronto International Film Festival (TIFF)
    console.log('\nğŸ“ 45. Scraping Toronto International Film Festival (TIFF)...')
    try {
      const tiffEvents = await scrapeTIFFEvents();
      let added45 = 0;
      for (const event of tiffEvents) {
        const existing = await eventsCollection.findOne({ sourceId: event.sourceId };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added45++;
        }
      }
      totalAdded += added45;
      console.log(`âœ… TIFF: ${added45} events`);
    } catch (error) {
      console.error(`âŒ TIFF failed: ${error.message}`);
    }

    // 46. Toronto Caribbean Carnival (Caribana)
    console.log('\nğŸ“ 46. Scraping Toronto Caribbean Carnival (Caribana)...')
    try {
      const caribanaEvents = await scrapeCaribanaEvents();
      let added46 = 0;
      for (const event of caribanaEvents) {
        const existing = await eventsCollection.findOne({ sourceId: event.sourceId };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added46++;
        }
      }
      totalAdded += added46;
      console.log(`âœ… Caribana: ${added46} events`);
    } catch (error) {
      console.error(`âŒ Caribana failed: ${error.message}`);
    }

    // 47. Toronto Pride Festival
    console.log('\nğŸ“ 47. Scraping Toronto Pride Festival...')
    try {
      const prideEvents = await scrapeTorontoPrideEvents();
      let added47 = 0;
      for (const event of prideEvents) {
        const existing = await eventsCollection.findOne({ sourceId: event.sourceId };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added47++;
        }
      }
      totalAdded += added47;
      console.log(`âœ… Toronto Pride: ${added47} events`);
    } catch (error) {
      console.error(`âŒ Toronto Pride failed: ${error.message}`);
    }

    // NEW GTA VENUE SCRAPERS - Major venues across the Greater Toronto Area

    // 48. Danforth Music Hall
    console.log('\nğŸ“ 48. Scraping Danforth Music Hall...')
    try {
      const danforthScraper = new DanforthMusicHallScraper();
      const danforthEvents = await danforthScraper.scrape();
      let added48 = 0;
      for (const event of danforthEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added48++;
        }
      }
      totalAdded += added48;
      console.log(`âœ… Danforth Music Hall: ${added48} events`);
    } catch (error) {
      console.error(`âŒ Danforth Music Hall failed: ${error.message}`);
    }

    // 49. Phoenix Concert Theatre
    console.log('\nğŸ“ 49. Scraping Phoenix Concert Theatre...')
    try {
      const phoenixScraper = new PhoenixConcertTheatreScraper();
      const phoenixEvents = await phoenixScraper.scrape();
      let added49 = 0;
      for (const event of phoenixEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added49++;
        }
      }
      totalAdded += added49;
      console.log(`âœ… Phoenix Concert Theatre: ${added49} events`);
    } catch (error) {
      console.error(`âŒ Phoenix Concert Theatre failed: ${error.message}`);
    }

    // 50. The Opera House
    console.log('\nğŸ“ 50. Scraping The Opera House...')
    try {
      const operaScraper = new OperaHouseScraper();
      const operaEvents = await operaScraper.scrape();
      let added50 = 0;
      for (const event of operaEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added50++;
        }
      }
      totalAdded += added50;
      console.log(`âœ… The Opera House: ${added50} events`);
    } catch (error) {
      console.error(`âŒ The Opera House failed: ${error.message}`);
    }

    // 51. Living Arts Centre (Mississauga)
    console.log('\nğŸ“ 51. Scraping Living Arts Centre (Mississauga)...')
    try {
      const livingArtsScraper = new LivingArtsCentreScraper();
      const livingArtsEvents = await livingArtsScraper.scrape();
      let added51 = 0;
      for (const event of livingArtsEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added51++;
        }
      }
      totalAdded += added51;
      console.log(`âœ… Living Arts Centre: ${added51} events`);
    } catch (error) {
      console.error(`âŒ Living Arts Centre failed: ${error.message}`);
    }

    // 52. Rose Theatre (Brampton)
    console.log('\nğŸ“ 52. Scraping Rose Theatre (Brampton)...')
    try {
      const roseScraper = new RoseTheatreScraper();
      const roseEvents = await roseScraper.scrape();
      let added52 = 0;
      for (const event of roseEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added52++;
        }
      }
      totalAdded += added52;
      console.log(`âœ… Rose Theatre: ${added52} events`);
    } catch (error) {
      console.error(`âŒ Rose Theatre failed: ${error.message}`);
    }

    // 53. University of Toronto Events
    console.log('\nğŸ“ 53. Scraping University of Toronto Events...')
    try {
      const uoftScraper = new UniversityOfTorontoEventsScraper();
      const uoftEvents = await uoftScraper.scrape();
      let added53 = 0;
      for (const event of uoftEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added53++;
        }
      }
      totalAdded += added53;
      console.log(`âœ… University of Toronto: ${added53} events`);
    } catch (error) {
      console.error(`âŒ University of Toronto failed: ${error.message}`);
    }

    // 54. York University Events
    console.log('\nğŸ“ 54. Scraping York University Events...')
    try {
      const yorkScraper = new YorkUniversityEventsScraper();
      const yorkEvents = await yorkScraper.scrape();
      let added54 = 0;
      for (const event of yorkEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added54++;
        }
      }
      totalAdded += added54;
      console.log(`âœ… York University: ${added54} events`);
    } catch (error) {
      console.error(`âŒ York University failed: ${error.message}`);
    }

    // 55. Markham Theatre
    console.log('\nğŸ“ 55. Scraping Markham Theatre...')
    try {
      const markhamScraper = new MarkhamTheatreScraper();
      const markhamEvents = await markhamScraper.scrape();
      let added55 = 0;
      for (const event of markhamEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added55++;
        }
      }
      totalAdded += added55;
      console.log(`âœ… Markham Theatre: ${added55} events`);
    } catch (error) {
      console.error(`âŒ Markham Theatre failed: ${error.message}`);
    }

    // 56. Burlington Performing Arts Centre
    console.log('\nğŸ“ 56. Scraping Burlington Performing Arts Centre...')
    try {
      const burlingtonScraper = new BurlingtonPerformingArtsScraper();
      const burlingtonEvents = await burlingtonScraper.scrape();
      let added56 = 0;
      for (const event of burlingtonEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added56++;
        }
      }
      totalAdded += added56;
      console.log(`âœ… Burlington PAC: ${added56} events`);
    } catch (error) {
      console.error(`âŒ Burlington PAC failed: ${error.message}`);
    }

    // 57. Oakville Centre for the Performing Arts
    console.log('\nğŸ“ 57. Scraping Oakville Centre...')
    try {
      const oakvilleScraper = new OakvilleCentreScraper();
      const oakvilleEvents = await oakvilleScraper.scrape();
      let added57 = 0;
      for (const event of oakvilleEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added57++;
        }
      }
      totalAdded += added57;
      console.log(`âœ… Oakville Centre: ${added57} events`);
    } catch (error) {
      console.error(`âŒ Oakville Centre failed: ${error.message}`);
    }

    // 58. Richmond Hill Centre
    console.log('\nğŸ“ 58. Scraping Richmond Hill Centre...')
    try {
      const richmondScraper = new RichmondHillCentreScraper();
      const richmondEvents = await richmondScraper.scrape();
      let added58 = 0;
      for (const event of richmondEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added58++;
        }
      }
      totalAdded += added58;
      console.log(`âœ… Richmond Hill Centre: ${added58} events`);
    } catch (error) {
      console.error(`âŒ Richmond Hill Centre failed: ${error.message}`);
    }

    // 59. Vaughan Mills Events
    console.log('\nğŸ“ 59. Scraping Vaughan Mills Events...')
    try {
      const vaughanScraper = new VaughanMillsEventsScraper();
      const vaughanEvents = await vaughanScraper.scrape();
      let added59 = 0;
      for (const event of vaughanEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added59++;
        }
      }
      totalAdded += added59;
      console.log(`âœ… Vaughan Mills: ${added59} events`);
    } catch (error) {
      console.error(`âŒ Vaughan Mills failed: ${error.message}`);
    }

    // 60. Regent Theatre Oshawa
    console.log('\nğŸ“ 60. Scraping Regent Theatre Oshawa...')
    try {
      const regentScraper = new RegentTheatreOshawaScraper();
      const regentEvents = await regentScraper.scrape();
      let added60 = 0;
      for (const event of regentEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added60++;
        }
      }
      totalAdded += added60;
      console.log(`âœ… Regent Theatre Oshawa: ${added60} events`);
    } catch (error) {
      console.error(`âŒ Regent Theatre Oshawa failed: ${error.message}`);
    }

    // 61. Pickering Casino Events
    console.log('\nğŸ“ 61. Scraping Pickering Casino Events...')
    try {
      const pickeringScraper = new PickeringCasinoEventsScraper();
      const pickeringEvents = await pickeringScraper.scrape();
      let added61 = 0;
      for (const event of pickeringEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added61++;
        }
      }
      totalAdded += added61;
      console.log(`âœ… Pickering Casino: ${added61} events`);
    } catch (error) {
      console.error(`âŒ Pickering Casino failed: ${error.message}`);
    }

    // 62. Ajax Community Events
    console.log('\nğŸ“ 62. Scraping Ajax Community Events...')
    try {
      const ajaxScraper = new AjaxCommunityEventsScraper();
      const ajaxEvents = await ajaxScraper.scrape();
      let added62 = 0;
      for (const event of ajaxEvents) {
        const existing = await eventsCollection.findOne({ title: event.title, startDate: event.startDate, 'venue.name': event.venue.name };
        if (!existing) {
          await eventsCollection.insertOne(event);
          added62++;
        }
      }
      totalAdded += added62;
      console.log(`âœ… Ajax Community: ${added62} events`);
    } catch (error) {
      console.error(`âŒ Ajax Community failed: ${error.message}`);
    }

    // Summary
    console.log('\n' + '=' .repeat(60));
    console.log('ğŸ“ˆ SCRAPING SUMMARY')
    console.log('=' .repeat(60));
    console.log(`ğŸ¯ Total events added: ${totalAdded}`);
    console.log('ğŸ“ Sources scraped:')
    console.log('   â€¢ Gerrard India Bazaar')
    console.log('   â€¢ Friends of Guild Park')
    console.log('   â€¢ Royal Ontario Museum')
    console.log('   â€¢ Horseshoe Tavern')
    console.log('   â€¢ Toronto Botanical Garden')
    console.log('   â€¢ MOCA Toronto')
    console.log('   â€¢ Toronto Zoo')
    console.log('   â€¢ Roncesvalles Village')
    console.log('   â€¢ Niagara Falls')
    console.log('   â€¢ City of Markham')
    console.log('   â€¢ Square One Shopping Centre')
    console.log('   â€¢ Wet\'n\'Wild Toronto')
    console.log('   â€¢ Art Gallery of Ontario (AGO)')
    console.log('   â€¢ Harbourfront Centre')
    console.log('   â€¢ Casa Loma')
    console.log('   â€¢ Distillery District')
    console.log('   â€¢ Royal Botanical Gardens')
    console.log('   â€¢ Gardiner Museum')
    console.log('   â€¢ Ripley\'s Aquarium')
    console.log('   â€¢ High Park')
    console.log('   â€¢ Evergreen Brick Works')
    console.log('   â€¢ Toronto Public Library')
    console.log('   â€¢ Riverwood Conservancy')
    console.log('   â€¢ Main Street Unionville')
    console.log('   â€¢ Future Nightlife')
    console.log('   â€¢ Nest Toronto')
    console.log('   â€¢ Oasis Aqualounge')
    console.log('   â€¢ Rebel Nightclub')
    console.log('   â€¢ Toybox Toronto')
    console.log('   â€¢ 44 Toronto')
    console.log('   â€¢ Century')
    console.log('   â€¢ DPRTMNT')
    console.log('   â€¢ Fiction Club')
    console.log('   â€¢ Lost 577')
    console.log('   â€¢ MIA Toronto')
    console.log('   â€¢ The Velvet')
    console.log('   â€¢ Vertigo')
    console.log('   â€¢ Revival Event Venue')
    console.log('   â€¢ Lula Lounge')
    console.log('   â€¢ Club 54')
    console.log('   â€¢ The X Club')
    console.log('   â€¢ Dirty Martini')
    console.log('   â€¢ The 6ix Lounge')
    console.log('   â€¢ Seventy Seven')

    // Get current total count
    const totalEvents = await eventsCollection.countDocuments({};
    console.log(`ğŸ“Š Total events in database: ${totalEvents}`);

    // Get Toronto-specific count
    const torontoEvents = await eventsCollection.countDocuments({
      $or: [
        { source: 'Gerrard India Bazaar' },
        { source: 'Friends of Guild Park' },
        { source: 'Royal Ontario Museum' },
        { source: 'Horseshoe Tavern' },
        { source: 'Toronto Botanical Garden' },
        { source: 'MOCA Toronto' },
        { source: 'Toronto Zoo' },
        { source: 'Roncesvalles Village' },
        { source: 'City of Niagara Falls' },
        { 'venue.city': 'Toronto' },
        { 'venue.city': 'Niagara Falls' }
      ]
    };
    console.log(`ğŸ™ï¸ Total Toronto events: ${torontoEvents}`);

    console.log('\nğŸ‰ Toronto event scraping completed successfully!')

  } catch (error) {
    console.error('âŒ Error in master scraper:', error.message);
  } finally {
    console.log('ğŸ”Œ MongoDB connection closed')
    await client.close();
  }
}

/**
 * Main function
 */
async function main() {
  await scrapeAllTorontoEvents('Toronto')
}

// Run the master scraper
if (require.main === module) {
  main();
}


// Function export wrapper added by targeted fixer

// Production async export added


// Surgical export fix
module.exports = scrapeAllTorontoEvents;